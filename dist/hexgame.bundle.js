!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.hexgame=e():t.hexgame=e()}(self,(function(){return(()=>{"use strict";var t={};(t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})})(t);class e{constructor(t,e){this.x=t,this.y=e}add(t){return new e(this.x+t.x,this.y+t.y)}subtract(t){return new e(this.x-t.x,this.y-t.y)}scale(t){return new e(this.x*t,this.y*t)}dot(t){return this.x*t.x+this.y*t.y}cross(t){return new e(this.y*t.x-this.x*t.y,this.x*t.y-this.y*t.x)}unit(){return this.scale(Math.inv(this.magnitude()))}magnitude(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}max(){return Math.max(this.x,this.y)}min(){return Math.min(this.x,this.y)}rotate(t){return new e(this.x*Math.cos(t)-this.y*Math.sin(t),this.x*Math.sin(t)+this.y*Math.cos(t))}equals(t){return this.x==t.x&&this.y==t.y}toString(){return`[${this.x}, ${this.y}]`}toArray(){return[this.x,this.y]}clone(){return new e(this.x,this.y)}get length(){return Math.sqrt(this.dot(this))}}class i{constructor(){window.addEventListener("keydown",(t=>this.handleKeyEvent(t,!0)),!1),window.addEventListener("keyup",(t=>this.handleKeyEvent(t,!1)),!1),this.input={UP:!1,DOWN:!1,LEFT:!1,RIGHT:!1}}handleKeyEvent(t,e){if(!t.defaultPrevented){switch(t.key){case"w":case"W":case"Up":case"ArrowUp":this.input.UP=e;break;case"s":case"S":case"Down":case"ArrowDown":this.input.DOWN=e;break;case"a":case"A":case"Left":case"ArrowLeft":this.input.LEFT=e;break;case"d":case"D":case"Right":case"ArrowRight":this.input.RIGHT=e;break;default:return}t.preventDefault()}}toString(){return JSON.stringify(this.input)}}class s{constructor(t){window.addEventListener("mousemove",(t=>this.handleMove(t)),!1),window.addEventListener("mousedown",(t=>this.handleKeyEvent(t,!0)),!1),window.addEventListener("mouseup",(t=>this.handleKeyEvent(t,!1)),!1),window.addEventListener("contextmenu",(t=>this.handleContextMenu(t)),!1),this.viewport=t,this.input={button:{LEFT:!1,MIDDLE:!1,RIGHT:!1},cursorX:0,cursorY:0}}handleKeyEvent(t,e){if((t=t||window.event).preventDefault(),"which"in t)switch(t.which){case 1:this.input.button.LEFT=e;break;case 2:this.input.button.MIDDLE=e;break;case 3:this.input.button.RIGHT=e}else if("button"in t)switch(t.button){case 0:this.input.button.LEFT=e;break;case 1:this.input.button.MIDDLE=e;break;case 2:this.input.button.RIGHT=e}}handleMove(t){(t=t||window.event).preventDefault(),this.input.cursorX=t.clientX,this.input.cursorY=t.clientY}handleContextMenu(t){(t=t||window.event).preventDefault()}getMousePosition(){let t=this.viewport.getBoundingClientRect();return new e(this.input.cursorX-t.left,this.input.cursorY-t.top)}toString(){return JSON.stringify(this.input)}}class n{constructor(t){if("Entity"==this.constructor)throw new Error("Abstract classes can't be instantiated.");const i={position:new e(0,0)};Object.assign(this,i,Object.fromEntries(Object.keys(i).filter((e=>e in t)).map((e=>[e,t[e]]))))}update(t){}draw(t){}get x(){return this.position.x}get y(){return this.position.y}}class a extends n{constructor(t){super(t);const e={label:"",value:"",callback:null};Object.assign(this,e,Object.fromEntries(Object.keys(e).filter((e=>e in t)).map((e=>[e,t[e]]))))}update(t){"function"==typeof this.callback&&(this.value=this.callback.call())}draw(t){t.font="16px Arial",t.fillStyle="black",t.fillText(this.toString(),this.position.x,this.position.y)}toString(){return`${this.label}: ${this.value}`}}class r extends n{constructor(t){if(super(t),"Polygon"==this.constructor)throw new Error("Abstract classes can't be instantiated.");const e={r:10,θ:Math.PI/180*90};Object.assign(this,e,Object.fromEntries(Object.keys(e).filter((e=>e in t)).map((e=>[e,t[e]]))))}getVertices(t){const i=[],s=new e(this.r,0);for(var n=0;n<t;n++){let e=this.position.add(s.rotate(n*(2*Math.PI/t)+this.θ));i.push(e)}return i}}class o extends r{constructor(t){super(t);const e={sides:4};Object.assign(this,e,Object.fromEntries(Object.keys(e).filter((e=>e in t)).map((e=>[e,t[e]]))))}update(t){const i=[];t.keyboard.input.LEFT&&i.push(new e(-1,0)),t.keyboard.input.RIGHT&&i.push(new e(1,0)),t.keyboard.input.UP&&i.push(new e(0,-1)),t.keyboard.input.DOWN&&i.push(new e(0,1));const s=i.reduce(((t,e)=>t.add(e)),new e(0,0));this.position=this.position.add(s)}draw(t){t.beginPath(),t.fillStyle="#a1b2c3";for(let e of this.getVertices(this.sides))t.lineTo(e.x,e.y);t.closePath(),t.stroke(),t.fill()}}class h{constructor(t,e,n,a){this.config={width:t,height:e,targetFps:n},this.viewport=class{static getPixelRatio=function(t){return console.log("Determining pixel ratio."),window.devicePixelRatio/["webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio"].reduce((function(e,i){return t.hasOwnProperty(i)?t[i]:1}))};static generateCanvas=function(t,e){console.log("Generating canvas.");var i=document.createElement("canvas"),s=i.getContext("2d"),n=this.getPixelRatio(s);return i.width=Math.round(t*n),i.height=Math.round(e*n),i.style.width=t+"px",i.style.height=e+"px",s.setTransform(n,0,0,n,0,0),i}}.generateCanvas(this.config.width,this.config.height),this.context=this.viewport.getContext("2d"),a.insertBefore(this.viewport,a.firstChild),this.state={status:"running",client:{curFPS:0,frameCount:0,lastFPSUpdate:0,framesThisSecond:0,tick:1e3/n,lastGameTick:0,nextGameTick:0},entities:[],keyboard:new i,mouse:new s(this.viewport)}}init(){this.state.entities=[],this.state.entities.push(new a({position:new e(10,30),label:"FPS",callback:()=>this.state.client.curFPS})),this.state.entities.push(new a({position:new e(10,50),label:"Frames",callback:()=>this.state.client.frameCount})),this.state.entities.push(new a({position:new e(10,70),label:"keysPressed",callback:()=>this.state.keyboard.toString()})),this.state.entities.push(new a({position:new e(10,90),label:"mouse",callback:()=>this.state.mouse.toString()})),this.state.entities.push(new o({position:new e(20,20),sides:4,r:20,θ:90})),this.frameid=window.requestAnimationFrame(this.gameTick.bind(this))}gameTick(t){"paused"==this.state.status&&cancelAnimationFrame(this.frameid),t>this.state.client.nextGameTick&&(this.state.client.nextGameTick+=this.state.client.tick,this.state.client.frameCount++,this.update(t),this.draw()),this.state.client.lastGameTick=t,this.frameid=window.requestAnimationFrame(this.gameTick.bind(this))}update(t){t>this.state.client.lastFPSUpdate+1e3?(this.state.client.curFPS=this.state.client.framesThisSecond,this.state.client.lastFPSUpdate=t,this.state.client.framesThisSecond=0):this.state.client.framesThisSecond++;for(let t of this.state.entities)t.update(this.state)}draw(){this.context.clearRect(0,0,this.config.width,this.config.height);for(let t of this.state.entities)t.draw(this.context)}}return document.addEventListener("DOMContentLoaded",(function(t){window.game=new h(800,600,60,document.querySelector("body")),window.game.init()})),t})()}));